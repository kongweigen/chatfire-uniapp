"use strict";const e=require("../../common/vendor.js"),a=require("../../api/index.js"),r=require("../../api/image/index.js");exports.useClear=()=>{const t=e.ref({width:"700rpx",height:"100rpx",color:"#ffffff",fontSize:"42rpx",borderRadius:"50rpx",background:"#007CFF"}),i=e.ref(!1),l=e.ref(!1),c=e.ref(""),s=e.ref(""),o=async e=>{c.value=setInterval((async()=>{if(l.value)return;l.value=!0;const r=await a.getTaskById(e).catch((()=>{u()}));l.value=!1,r.picArr&&(s.value=r.picArr[0].src,u())}),3e3)},u=()=>{l.value=!1,i.value=!1,clearInterval(c.value)},n=e.ref({});return{customStyle:t,sourceImage:n,imageUrl:s,uploadImage:()=>{e.index.chooseImage({success:a=>{const r=a.tempFiles[0],t=a.tempFilePaths[0];e.index.uploadFile({url:"https://agi.chatfire.cn/box/chat/file",filePath:t,name:"file",header:{Authorization:"Bearer eyJhbGciOiJIUzUxMiJ9.eyJ1c2VyX2lkIjoxODI0MTAyMzM0OTkzNzcyNTQ0LCJ1c2VyX2tleSI6IjgyMTIxYjdhLWU3MjMtNDYwMC1hMTlhLTAxYmIzODUzMWY0YSIsInVzZXJuYW1lIjoidGVzdCJ9.QckzY4WTJRTe9E0CGdlrzpL_DuQBBJnT7DYOjAJVmVhsLotGKnP597A-jBqid8H7UnMFiwG1JFRSf63PzvBvuQ"},formData:{file:r,purpose:"oss"},success:e=>{n.value=JSON.parse(e.data).data}})}})},generate:async()=>{const e=(a=n.value.url,t=n.value.url,{type:"3",original_url:a,thumb_url:t,query:"ChatfireAIå›¾ç‰‡åŠ©æ‰‹",image_source:"1",picInfo:"",picInfo2:"",text:"",ext_ratio:"",expand_zoom:"",clid:"1",front_display:"2",create_level:"0",style:"",is_first:!0});var a,t;console.log("generateImagePcedit ",e);const i=await r.generateImagePcedit(e).catch((()=>u()));i&&o(i.id)}}};
